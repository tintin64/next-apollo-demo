{"ast":null,"code":"import _defineProperty from \"/Users/sandeeppasunuri/workspace/next-apollo-demo/client/node_modules/@babel/runtime/helpers/esm/defineProperty\";\n\nvar _s = $RefreshSig$();\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { useQuery } from \"@apollo/client\";\nimport { useCallback, useEffect, useState } from \"react\";\n\nvar useCustomQuery = function useCustomQuery(query, options) {\n  _s();\n\n  var _useQuery = useQuery(query, options),\n      data = _useQuery.data,\n      loading = _useQuery.loading,\n      error = _useQuery.error,\n      fetchMore = _useQuery.fetchMore,\n      client = _useQuery.client;\n\n  var _useState = useState(data === null || data === void 0 ? void 0 : data.users),\n      users = _useState[0],\n      setUsers = _useState[1];\n\n  useEffect(function () {\n    return function () {\n      client.cache.modify({\n        fields: {\n          users: function users(value) {\n            return _objectSpread(_objectSpread({}, value), {}, {\n              result: []\n            });\n          }\n        }\n      });\n    };\n  }, [client]);\n  var loadMore = useCallback(function () {\n    return fetchMore({\n      variables: {\n        offset: data.users.result.length\n      }\n    });\n  }, [fetchMore, data]);\n  return [data, loading, error, loadMore, users];\n};\n\n_s(useCustomQuery, \"ol+36GwlJOHemeyoyQ3XacaJ+pM=\", false, function () {\n  return [useQuery];\n});\n\nexport default useCustomQuery;","map":{"version":3,"sources":["/Users/sandeeppasunuri/workspace/next-apollo-demo/client/hooks/useCustomQuery.ts"],"names":["useQuery","useCallback","useEffect","useState","useCustomQuery","query","options","data","loading","error","fetchMore","client","users","setUsers","cache","modify","fields","value","result","loadMore","variables","offset","length"],"mappings":";;;;;;;;AAAA,SAAyCA,QAAzC,QAAyD,gBAAzD;AACA,SAASC,WAAT,EAAsBC,SAAtB,EAAiCC,QAAjC,QAAiD,OAAjD;;AAGA,IAAMC,cAAc,GAAG,SAAjBA,cAAiB,CACnBC,KADmB,EACOC,OADP,EAIlB;AAAA;;AAAA,kBAGGN,QAAQ,CACRK,KADQ,EAERC,OAFQ,CAHX;AAAA,MAEGC,IAFH,aAEGA,IAFH;AAAA,MAESC,OAFT,aAESA,OAFT;AAAA,MAEkBC,KAFlB,aAEkBA,KAFlB;AAAA,MAEyBC,SAFzB,aAEyBA,SAFzB;AAAA,MAEoCC,MAFpC,aAEoCA,MAFpC;;AAAA,kBAQyBR,QAAQ,CAACI,IAAD,aAACA,IAAD,uBAACA,IAAI,CAAEK,KAAP,CARjC;AAAA,MAQMA,KARN;AAAA,MAQaC,QARb;;AAUDX,EAAAA,SAAS,CAAC,YAAM;AACZ,WAAO,YAAM;AACTS,MAAAA,MAAM,CAACG,KAAP,CAAaC,MAAb,CAAoB;AAChBC,QAAAA,MAAM,EAAE;AACJJ,UAAAA,KAAK,EAAE,eAAAK,KAAK;AAAA,mDACLA,KADK;AAERC,cAAAA,MAAM,EAAE;AAFA;AAAA;AADR;AADQ,OAApB;AAQH,KATD;AAUH,GAXQ,EAWN,CAACP,MAAD,CAXM,CAAT;AAaA,MAAMQ,QAAQ,GAAGlB,WAAW,CACxB;AAAA,WAAMS,SAAS,CAAC;AAACU,MAAAA,SAAS,EAAE;AAACC,QAAAA,MAAM,EAAEd,IAAI,CAACK,KAAL,CAAWM,MAAX,CAAkBI;AAA3B;AAAZ,KAAD,CAAf;AAAA,GADwB,EAExB,CAACZ,SAAD,EAAYH,IAAZ,CAFwB,CAA5B;AAKA,SAAO,CAACA,IAAD,EAAOC,OAAP,EAAgBC,KAAhB,EAAuBU,QAAvB,EAAiCP,KAAjC,CAAP;AACH,CAjCD;;GAAMR,c;UAOEJ,Q;;;AA4BR,eAAeI,cAAf","sourcesContent":["import { ApolloError, TypedDocumentNode, useQuery } from \"@apollo/client\";\nimport { useCallback, useEffect, useState } from \"react\";\nimport { UsersType } from '../types/user-types';\n\nconst useCustomQuery = (\n    query: TypedDocumentNode, options: Object\n):[\n    { [key: string]: any, users?: UsersType }, Boolean, ApolloError, Function\n] => {\n    const {\n        data, loading, error, fetchMore, client\n    } = useQuery(\n        query,\n        options\n    );\n\n    const [users, setUsers] = useState(data?.users);\n\n    useEffect(() => {\n        return () => {\n            client.cache.modify({\n                fields: {\n                    users: value => ({\n                        ...value,\n                        result: []\n                    })\n                }\n            });\n        }\n    }, [client]);\n\n    const loadMore = useCallback(\n        () => fetchMore({variables: {offset: data.users.result.length}}),\n        [fetchMore, data]\n    );\n\n    return [data, loading, error, loadMore, users];\n};\n\nexport default useCustomQuery;"]},"metadata":{},"sourceType":"module"}